---
title: SubmittedImageCleaningService
---
import { CollapsibleInherited } from "@/components/collapsible"
import { TypeTable } from "@/components/type_table"
import { CSharpType } from "@/components/csharp_type"


Namespace: <a href='../Data'>Commissiestrijd.Data</a>  
Assembly: backend.dll  

Service for cleaning up old submitted images.
This service runs in the background and periodically checks for submitted tasks
that are older than a year and have an associated image.
It deletes the image files and clears the image path in the database.
The service is designed to run at midnight every day.
It uses a background service to perform the cleanup operation asynchronously.

```csharp
public class SubmittedImageCleaningService : BackgroundService, IHostedService, IDisposable
```

#### Inheritance

<a href='https://learn.microsoft.com/dotnet/api/system.object' target='_blank' className="no-underline text-inherit hover:text-inherit inline"><CSharpType type='object' /></a> ← <a href='https://learn.microsoft.com/dotnet/api/microsoft.extensions.hosting.backgroundservice' target='_blank' className="no-underline text-inherit hover:text-inherit inline"><CSharpType type='BackgroundService' /></a> ← <a href='' target='_self' className="no-underline text-inherit hover:text-inherit inline"><CSharpType type='SubmittedImageCleaningService' /></a>

---
#### Implements

<a href='https://learn.microsoft.com/dotnet/api/microsoft.extensions.hosting.ihostedservice' target='_blank' className="no-underline text-inherit hover:text-inherit inline"><CSharpType type='IHostedService' /></a>, 
<a href='https://learn.microsoft.com/dotnet/api/system.idisposable' target='_blank' className="no-underline text-inherit hover:text-inherit inline"><CSharpType type='IDisposable' /></a>



<CollapsibleInherited title='Show Inherited Members (12)'>
[BackgroundService.Dispose\(\)](https://learn.microsoft.com/dotnet/api/microsoft.extensions.hosting.backgroundservice.dispose), 
[BackgroundService.ExecuteAsync\(CancellationToken\)](https://learn.microsoft.com/dotnet/api/microsoft.extensions.hosting.backgroundservice.executeasync), 
[BackgroundService.StartAsync\(CancellationToken\)](https://learn.microsoft.com/dotnet/api/microsoft.extensions.hosting.backgroundservice.startasync), 
[BackgroundService.StopAsync\(CancellationToken\)](https://learn.microsoft.com/dotnet/api/microsoft.extensions.hosting.backgroundservice.stopasync), 
[BackgroundService.ExecuteTask](https://learn.microsoft.com/dotnet/api/microsoft.extensions.hosting.backgroundservice.executetask), 
[object.Equals\(object?\)](https://learn.microsoft.com/dotnet/api/system.object.equals\#system\-object\-equals\(system\-object\)), 
[object.Equals\(object?, object?\)](https://learn.microsoft.com/dotnet/api/system.object.equals\#system\-object\-equals\(system\-object\-system\-object\)), 
[object.GetHashCode\(\)](https://learn.microsoft.com/dotnet/api/system.object.gethashcode), 
[object.GetType\(\)](https://learn.microsoft.com/dotnet/api/system.object.gettype), 
[object.MemberwiseClone\(\)](https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone), 
[object.ReferenceEquals\(object?, object?\)](https://learn.microsoft.com/dotnet/api/system.object.referenceequals), 
[object.ToString\(\)](https://learn.microsoft.com/dotnet/api/system.object.tostring)
</CollapsibleInherited>

---
## Constructors

---
###  SubmittedImageCleaningService\(IServiceProvider, ILogger\<SubmittedImageCleaningService\>\)

Initializes a new instance of the SubmittedImageCleaningService class.
This constructor is used to set up the service with the provided service provider and logger.

```csharp
public SubmittedImageCleaningService(IServiceProvider serviceProvider, ILogger<SubmittedImageCleaningService> logger)
```

<h4 className='mb-0 ml-1'>Parameters</h4>
<TypeTable types={[{"name":"serviceProvider","type":"IServiceProvider","links":["https://learn.microsoft.com/dotnet/api/system.iserviceprovider"],"description":""},{"name":"logger","type":"ILogger","links":["https://learn.microsoft.com/dotnet/api/microsoft.extensions.logging.ilogger-1"],"description":""}]} />

---
## Methods

---
###  ExecuteAsync\(CancellationToken\)

Executes the background service.
This method runs in a loop, waiting until midnight to perform the cleanup operation.
It retrieves all submitted tasks that are older than a year and have an associated image,
deletes the image files from the filesystem, and clears the image path in the database.
The service handles exceptions during the cleanup process and logs any errors encountered.
The cleanup operation is performed asynchronously to avoid blocking the main thread.

```csharp
protected override Task ExecuteAsync(CancellationToken stoppingToken)
```

<h4 className='mb-0 ml-1'>Parameters</h4>
<TypeTable types={[{"name":"stoppingToken","type":"CancellationToken","links":["https://learn.microsoft.com/dotnet/api/system.threading.cancellationtoken"],"description":""}]} />

<h4 className='mb-0 ml-1'>Returns</h4>
<TypeTable types={[{"name":"","type":"Task","links":["https://learn.microsoft.com/dotnet/api/system.threading.tasks.task"],"description":""}]} />
